/*******************************************************************************
 *
 * Module: Application Layer
 *
 * File Name: main.c
 *
 * Description: Main application file
 *
 * Author: Yousouf Soliman
 *******************************************************************************/
/*******************************************************************************
 *                                Inclusions                                   *
 *******************************************************************************/
#include "mbedtls_includes/mbedtls/sha256.h"
#include "Service_Layer/Std_Types.h"
#include "UART/uart.h"
#include "PORT/Port.h"
/*******************************************************************************
 *                             Definitions                                     *
 *******************************************************************************/
#define SHA256 0
#define SHA224 1
typedef Test_Array_Data_Type uint8;
/*******************************************************************************
 *                             Configurations                                  *
 *******************************************************************************/
/* UART configuration struct (8-N-1 @ 115200) */
static UART_ConfigType UART_Config = { BitData_8, Parity_Disabled, StopBit_1,
                                       BaudRate_115200, HSM_off };

/*******************************************************************************
 *                     Private Function Definition                             *
 *******************************************************************************/
/*******************************************************************************
 * Function: SetUpHardware
 * -----------------------
 * Initialize all peripherals before entering main loop.
 *******************************************************************************/
static void SetUpHardware(void)
{
    Port_Init(&Port_PinConfig); /* GPIO setup */
    UART0_Init(&UART_Config); /* UART0 */

}

/*******************************************************************************
 *                         Function Definitions                                *
 *******************************************************************************/
/*******************************************************************************
 * Function: main
 * --------------
 * Application entry point.
 *******************************************************************************/

uint8 main(void)
{
    Test_Array_Data_Type Test_Array[] = "test string for sha 256";
    Test_Array_Data_Type Result_Array[32] = 0;
    uint8 Test_Array_Size = (sizeof(Test_Array))
            / (sizeof(Test_Array_Data_Type));

    for (;;)
    {

        uint32 Sha256Fail = mbedtls_sha256(Test_Array, Test_Array_Size,
                                           Result_Array,
                                           SHA256);
        if (!Sha256Fail)
        {
            UART0_SendString(Result_Array);
        }
        else if (Sha256Fail)
        {
            UART0_SendString("SHA-256 Failed");
        }
        else
        {
            /* Do Nothing */
        }
    }
    return 0;
}
/*******************************************************************************
 *                            End of file                                      *
 *******************************************************************************/

